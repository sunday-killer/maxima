"use strict";Vue.use(window.vuelidate.default);var t=window.validators,e=t.required,i=t.numeric;t.maxLength;new Vue({el:"#app",data:{name:"",price:0,description:"",details:"",productsList:{},error:null,isLoading:!1,editableProductId:null},validations:{name:{required:e},price:{required:e,numeric:i},description:{required:e},details:{required:e}},methods:{saveProduct:function(){var e=this;if(this.isInvalid())this.$v.$touch();else{var t={name:this.name,price:+this.price,description:this.description,details:this.details};this.isLoading=!0,null===this.editableProductId?$.ajax({url:PATH+"ajax/createProduct.php",type:"POST",dataType:"JSON",data:t,success:function(t){console.log(t),e.isLoading=!1,Vue.set(e.productsList,t,{name:e.name,price:+e.price,description:e.description,details:e.details}),e.clearForm()},error:function(t){console.error(t),this.error=t}}):(t.id=this.editableProductId,$.ajax({url:PATH+"ajax/updateProduct.php",type:"POST",dataType:"JSON",data:t,success:function(t){console.log(t),Vue.set(e.productsList,e.editableProductId,{name:e.name,price:+e.price,description:e.description,details:e.details}),e.clearForm(),e.isLoading=!1},error:function(t){console.error(t),this.error=t,this.clearForm(),this.editableProductId=null}}))}},getProductList:function(){var e=this;this.isLoading=!0,$.ajax({url:PATH+"ajax/getProductsList.php",type:"POST",dataType:"JSON",success:function(t){e.productsList=t,e.isLoading=!1},error:function(t){console.error(t),this.error=t}})},deleteProduct:function(e){var i=this;Swal.fire({title:"Вы уверены, что хотите удалить?",text:"Это действие нельзя будет отменить!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Да, удаляем!",cancelButtonText:"Пожалуй не надо!"}).then(function(t){t.value&&$.ajax({url:PATH+"ajax/deleteProduct.php",type:"POST",dataType:"JSON",data:{id:e},success:function(t){console.log(t),Vue.delete(i.productsList,e),Swal.fire("Удалено!","","success")},error:function(t){console.error(t),this.error=t}})})},updateProduct:function(t){var e=this;this.editableProductId=t,this.name=this.productsList[t].name,this.price=this.productsList[t].price,this.description=this.productsList[t].description,this.details=this.productsList[t].details,setTimeout(function(){M.updateTextFields(),M.textareaAutoResize(e.$refs.description),M.textareaAutoResize(e.$refs.details)},0)},clearForm:function(){var t=this;this.name="",this.price=0,this.description="",this.details="",this.editableProductId=null,this.$v.$reset(),setTimeout(function(){M.textareaAutoResize(t.$refs.description),M.textareaAutoResize(t.$refs.details)})},status:function(t){return{error:t.$error,dirty:t.$dirty}},isInvalid:function(){return!(this.$v.name.$error&&this.$v.price.$error&&this.$v.description.$error&&this.$v.details.$error)}},mounted:function(){this.getProductList()}});